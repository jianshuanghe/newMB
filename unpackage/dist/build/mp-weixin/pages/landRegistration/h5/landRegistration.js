(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/landRegistration/h5/landRegistration"],{"27c1":function(o,e,t){"use strict";t.r(e);var n=t("2d6b"),a=t.n(n);for(var s in n)"default"!==s&&function(o){t.d(e,o,function(){return n[o]})}(s);e["default"]=a.a},"2d6b":function(o,e,t){"use strict";(function(o){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=function(){return t.e("components/common/watch-login/watch-input").then(t.bind(null,"ec11"))},a={name:"landRegistration",components:{wInput:n},data:function(){return{browserType:"",logo:this.Static+"mbcImg/landRegistration/logo.png",loadingShow:!1,isOvertime:!1,phoneLand:{phone:"",code:"",passWord:""},passWordLand:{phone:"",passWord:""},word:"发送验证码",setPassWorld:!1,landType:1,password:""}},created:function(){if(o.getStorageSync("landRegist")){var e=JSON.parse(o.getStorageSync("landRegist"));""!==e.user.password&&null!==e.user.password&&void 0!==e.user.password||(this.setPassWorld=!0)}else o.setStorageSync("tabItems",1);o.getStorageSync("landType")&&(this.landType=Number(o.getStorageSync("landType"))),"WX"===o.getStorageSync("browserType")?this.browserType="WX":"FWX"===o.getStorageSync("browserType")&&(this.browserType="FWX")},mounted:function(){console.log(this.api2,"全局数据")},methods:{sendMessage:function(){var e=this.phoneLand.phone;return""===e?(o.showToast({title:"手机号为不能为空",icon:"none",duration:1e3}),!1):/^1[34578]\d{9}$/.test(e)?!this.isOvertime&&void this.getCode():(o.showToast({title:"手机号码有误,请重填",icon:"none",duration:1e3}),!1)},sendState:function(){var o=this,e=60,t=setInterval(function(){o.isOvertime=!0,e--,o.word="重新获取("+e+"s)",e<0&&(o.isOvertime=!1,clearInterval(t),o.word="获取验证码")},1e3)},getCode:function(){var e=this;o.showLoading({title:"加载中"});var t={phone:this.phoneLand.phone,businessName:"1",portal:"ruhexiu"};o.request({url:this.api1+"/rest-sso/phoneSms",data:t,method:"POST",header:{"custom-header":"hello"},success:function(t){console.log(t.data),"200"===t.data.ret?(o.hideLoading(),o.showToast({title:"短信发送成功",icon:"none",duration:1e3}),e.sendState()):(o.hideLoading(),o.showToast({title:t.data.msg,icon:"none",duration:1e3}))},fail:function(e){o.hideLoading(),o.showToast({title:"网络繁忙，请稍后",icon:"none",duration:1e3}),console.log(e,"网络繁忙，请稍后")}})},clickPassWordLand:function(){console.log("触发账号密码登录按钮"),this.landType=2,o.setStorageSync("landType",this.landType)},clickPhoneLand:function(){console.log("触发手机号登录按钮"),this.landType=1,o.setStorageSync("landType",this.landType)},clickForgetPassWord:function(){console.log("触发忘记密码按钮"),o.navigateTo({url:"/pages/landRegistration/h5/forgetPassWord"})},clickLand:function(){console.log("触发登录按钮"),1===this.landType?(console.log("手机号登录"),this.phoneLandFn()):2===this.landType&&(console.log("密码登录"),this.passWordLandFn())},phoneLandFn:function(){var e=this,t=this.phoneLand.code,n=this.phoneLand.phone;if(""===n)return o.showToast({title:"手机号为不能为空",icon:"none",duration:1e3}),!1;if(!/^1[34578]\d{9}$/.test(n))return o.showToast({title:"手机号码有误,请重填",icon:"none",duration:1e3}),!1;if(""===t)return o.showToast({title:"短信验证码不能为空",icon:"none",duration:1e3}),!1;if(!/^\d{4}$/.test(t))return o.showToast({title:"验证码格式有误,请重填",icon:"none",duration:1e3}),!1;o.showLoading({title:"加载中"});var a={phone:this.phoneLand.phone,loginType:"0",phoneCode:this.phoneLand.code};o.request({url:this.api2+"/rest-rp/mbUser/login",data:a,method:"POST",header:{},success:function(t){if(console.log(t.data),"200"===String(t.data.ret)){o.hideLoading();var n={randomKey:"",token:t.data.content.sign,user:{id:t.data.content.user.id}};o.setStorageSync("landRegist",JSON.stringify(n)),console.log("登陆成功！"),e.password=t.data.content.user.password,e.getUserData()}else o.hideLoading(),o.showToast({title:t.data.msg,icon:"none",duration:1e3})},fail:function(e){o.hideLoading(),o.showToast({title:"网络繁忙，请稍后",icon:"none",duration:1e3}),console.log(e,"网络繁忙，请稍后")}})},passWordLandFn:function(){var e=this,t=this.passWordLand.phone,n=this.passWordLand.passWord;if(console.log(this.passWordLand),""===t)return o.showToast({title:"手机号为不能为空",icon:"none",duration:1e3}),!1;if(!/^1[34578]\d{9}$/.test(t))return o.showToast({title:"手机号码有误,请重填",icon:"none",duration:1e3}),!1;if(""===n)return o.showToast({title:"密码为不能为空",icon:"none",duration:1e3}),!1;if(n.length<6)return o.showToast({title:"密码不能少于6个字符",icon:"none",duration:1e3}),!1;o.showLoading({title:"加载中"});var a={phone:this.passWordLand.phone,loginType:"1",passWord:this.passWordLand.passWord};o.request({url:this.api2+"/rest-rp/mbUser/login",data:a,method:"POST",header:{"custom-header":"hello"},success:function(t){if(console.log(t.data),"200"===String(t.data.ret)){o.hideLoading();var n={randomKey:t.data.content.randomKey,token:t.data.content.token,user:{id:t.data.content.user.id}};o.setStorageSync("landRegist",JSON.stringify(n)),e.password=t.data.content.user.password,e.getUserData()}else o.hideLoading(),o.showToast({title:t.data.msg,icon:"none",duration:1e3})},fail:function(e){o.hideLoading(),o.showToast({title:"网络繁忙，请稍后",icon:"none",duration:1e3}),console.log(e,"网络繁忙，请稍后")}})},getUserData:function(){var e=this;console.log("获取用户信息，全部");var t=JSON.parse(o.getStorageSync("landRegist"));console.log(t.user.id),o.request({url:this.api2+"/rest-rp/user/"+t.user.id,data:{},header:{Authorization:"Bearer "+t.token},success:function(t){if(console.log(t.data),"200"===String(t.data.ret)){var n=t.data.content;o.setStorageSync("UserData",JSON.stringify(n)),""===e.password||null===e.password||void 0===e.password?e.setPassWorld=!0:(o.showToast({title:"登陆成功",icon:"none",duration:500}),o.navigateBack({delta:1}),setTimeout(function(){o.navigateTo({url:"/pages/project/MBBO/home"})},500))}else o.hideLoading(),o.showToast({title:t.data.msg,icon:"none",duration:500})},fail:function(e){o.hideLoading(),o.showToast({title:"网络繁忙，请稍后",icon:"none",duration:1e3}),console.log(e,"网络繁忙，请稍后")}})},clickSetPassWorld:function(){var e=this;console.log("触发保存密码按钮");var t=this.phoneLand.passWord;if(""===t)return o.showToast({title:"密码不能为空",icon:"none",duration:500}),!1;if(t.length<6)return o.showToast({title:"密码不能少于6个字符",icon:"none",duration:500}),!1;var n={passWord:this.phoneLand.passWord};if(o.getStorageSync("landRegist")){var a=JSON.parse(o.getStorageSync("landRegist"));console.log(a.user.id),o.showLoading({title:"加载中"}),o.request({url:this.api2+"/rest-rp/user/"+a.user.id,data:this.endParams(n),method:"POST",header:{Authorization:"Bearer "+a.token},success:function(t){if(console.log(t.data),"200"===String(t.data.ret)){if(o.hideLoading(),o.showToast({title:"登陆成功！",icon:"none",duration:500}),o.getStorageSync("landRegist")){var n=JSON.parse(o.getStorageSync("landRegist"));n.user.password=e.phoneLand.passWord,o.setStorageSync("landRegist",JSON.stringify(n))}setTimeout(function(){o.navigateTo({url:"/pages/project/MBBO/home"})},500)}else o.hideLoading(),o.showToast({title:t.data.msg,icon:"none",duration:500})},fail:function(e){o.hideLoading(),o.showToast({title:"网络繁忙，请稍后",icon:"none",duration:1e3}),console.log(e,"网络繁忙，请稍后")}})}},clickSkipLand:function(){console.log("触发暂不设置"),o.navigateTo({url:"/pages/project/MBBO/home"})},clickWxLand:function(){console.log("触发微信登录");var e=o.getStorageSync("UUID");window.location.href=this.api2+"/wechat/portal/goWxLogin?uuid="+e}}};e.default=a}).call(this,t("543d")["default"])},"504f":function(o,e,t){"use strict";t.r(e);var n=t("e92c"),a=t("27c1");for(var s in a)"default"!==s&&function(o){t.d(e,o,function(){return a[o]})}(s);t("b02a");var i=t("2877"),r=Object(i["a"])(a["default"],n["a"],n["b"],!1,null,"0991a778",null);e["default"]=r.exports},"62d0":function(o,e,t){},b02a:function(o,e,t){"use strict";var n=t("62d0"),a=t.n(n);a.a},e92c:function(o,e,t){"use strict";var n=function(){var o=this,e=o.$createElement;o._self._c},a=[];t.d(e,"a",function(){return n}),t.d(e,"b",function(){return a})}},[["5701","common/runtime","common/vendor"]]]);