(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-landRegistration-h5-landRegistration"],{"6f4d":function(t,n,i){"use strict";i.r(n);var a=i("b25d0"),e=i("c3af");for(var o in e)"default"!==o&&function(t){i.d(n,t,function(){return e[t]})}(o);i("bdd0");var s=i("2877"),d=Object(s["a"])(e["default"],a["a"],a["b"],!1,null,"a5e30066",null);n["default"]=d.exports},b25d0:function(t,n,i){"use strict";var a=function(){var t=this,n=t.$createElement,i=t._self._c||n;return i("v-uni-view",{staticClass:"landRegistration-content"},[i("v-uni-view",{staticClass:"landRegistration"},[i("v-uni-view",{staticClass:"phone-passWord-LR"},[1!==t.landType||t.setPassWorld?t._e():i("v-uni-view",{staticClass:"phonw-LR"},[i("v-uni-view",{staticClass:"top-PLR"},[i("p",{},[t._v("你好，"),i("br"),t._v("欢迎来到陌拜")])]),i("v-uni-view",{staticClass:"LR-cont"},[i("v-uni-view",{staticClass:"inputPhone-PLR"},[i("wInput",{attrs:{type:"number",maxlength:"11",placeholder:"请输入手机号码",inputWidth:"85vw"},model:{value:t.phoneLand.phone,callback:function(n){t.$set(t.phoneLand,"phone",n)},expression:"phoneLand.phone"}}),i("v-uni-view",{staticClass:"line"})],1),i("v-uni-view",{staticClass:"inputYan-PLR"},[i("v-uni-view",{staticClass:"yan-left-PLR left"},[i("wInput",{attrs:{type:"number",maxlength:"4",placeholder:"请输入验证码",inputWidth:"60vw"},model:{value:t.phoneLand.code,callback:function(n){t.$set(t.phoneLand,"code",n)},expression:"phoneLand.code"}})],1),i("v-uni-view",{staticClass:"ma-right-PLR left"},[i("v-uni-view",{class:{yazm:t.isOvertime,"re-yazm":!t.isOvertime},attrs:{type:"primary","action-type":"button",mini:""},on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.sendMessage.apply(void 0,arguments)}}},[t._v(t._s(t.word))])],1),i("v-uni-view",{staticClass:"clear"}),i("v-uni-view",{staticClass:"line"})],1),i("v-uni-view",{staticClass:"switchPassWorld"},[i("p",{on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.clickPassWordLand.apply(void 0,arguments)}}},[t._v("账号密码登录")])])],1)],1),2!==t.landType||t.setPassWorld?t._e():i("v-uni-view",{staticClass:"passWord-LR"},[i("v-uni-view",{staticClass:"top-PLR"},[i("p",{},[t._v("你好，"),i("br"),t._v("欢迎来到陌拜")])]),i("v-uni-view",{staticClass:"LR-cont"},[i("v-uni-view",{staticClass:"inputPhone-PLR"},[i("wInput",{attrs:{type:"number",maxlength:"11",placeholder:"请输入手机号码",inputWidth:"85vw"},model:{value:t.passWordLand.phone,callback:function(n){t.$set(t.passWordLand,"phone",n)},expression:"passWordLand.phone"}}),i("v-uni-view",{staticClass:"line"})],1),i("v-uni-view",{staticClass:"inputPhone-PLR"},[i("wInput",{attrs:{type:"password",placeholder:"请输入密码",inputWidth:"80vw"},model:{value:t.passWordLand.passWord,callback:function(n){t.$set(t.passWordLand,"passWord",n)},expression:"passWordLand.passWord"}}),i("v-uni-view",{staticClass:"line"})],1),i("v-uni-view",{staticClass:"switchPassWorld"},[i("p",{staticClass:"left",on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.clickPhoneLand.apply(void 0,arguments)}}},[t._v("手机号验证码登录")]),i("p",{staticClass:"right text-Right",on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.clickForgetPassWord.apply(void 0,arguments)}}},[t._v("忘记密码")]),i("v-uni-view",{staticClass:"clear"})],1)],1)],1),t.setPassWorld?i("v-uni-view",{staticClass:"passWord-LR"},[i("v-uni-view",{staticClass:"top-PWLR"},[i("img",{attrs:{src:t.logo,alt:""}})]),i("v-uni-view",{staticClass:"LR-cont"},[i("v-uni-view",{staticClass:"inputPhone-PLR"},[i("wInput",{attrs:{type:"password",placeholder:"请设置登录密码",inputWidth:"85vw"},model:{value:t.phoneLand.passWord,callback:function(n){t.$set(t.phoneLand,"passWord",n)},expression:"phoneLand.passWord"}}),i("v-uni-view",{staticClass:"line"})],1)],1)],1):t._e(),i("v-uni-view",{staticClass:"landBtn"},[t.setPassWorld?t._e():i("v-uni-view",{},[i("v-uni-view",{staticClass:"land-btn-box",on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.clickLand.apply(void 0,arguments)}}},[i("p",{},[t._v("登录")])]),"WX"===t.browserType?i("v-uni-view",{staticClass:"land-btn-box",on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.clickWxLand.apply(void 0,arguments)}}},[i("p",{staticClass:"wx-land"},[t._v("微信账号登录")])]):t._e()],1),t.setPassWorld?i("v-uni-view",{staticClass:"land-btn-box"},[i("p",{on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.clickSetPassWorld.apply(void 0,arguments)}}},[t._v("保存")]),i("v-uni-view",{staticClass:"skipLand",on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.clickSkipLand.apply(void 0,arguments)}}},[i("p",{},[t._v("暂不设置")])])],1):t._e()],1)],1)],1)],1)},e=[];i.d(n,"a",function(){return a}),i.d(n,"b",function(){return e})},bdd0:function(t,n,i){"use strict";var a=i("e5d6"),e=i.n(a);e.a},c3af:function(t,n,i){"use strict";i.r(n);var a=i("eae1"),e=i.n(a);for(var o in a)"default"!==o&&function(t){i.d(n,t,function(){return a[t]})}(o);n["default"]=e.a},e5d6:function(t,n,i){var a=i("eb5c");"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var e=i("4f06").default;e("5a4dd784",a,!0,{sourceMap:!1,shadowMode:!1})},eae1:function(t,n,i){"use strict";(function(t){var a=i("288e");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0,i("28a5");var e=a(i("f499"));i("c5f6");var o=a(i("6c29")),s={name:"landRegistration",components:{wInput:o.default},data:function(){return{browserType:"",logo:this.Static+"images/business/home/landRegistration/logo.png",loadingShow:!1,isOvertime:!1,phoneLand:{phone:"",code:"",passWord:""},passWordLand:{phone:"",passWord:""},word:"发送验证码",setPassWorld:!1,landType:1,password:""}},created:function(){if(uni.getStorageSync("landRegist")){var t=JSON.parse(uni.getStorageSync("landRegist"));""!==t.user.password&&null!==t.user.password&&void 0!==t.user.password||(this.setPassWorld=!0)}else uni.setStorageSync("tabItems",1);uni.getStorageSync("landType")&&(this.landType=Number(uni.getStorageSync("landType"))),"WX"===uni.getStorageSync("browserType")?this.browserType="WX":"FWX"===uni.getStorageSync("browserType")&&(this.browserType="FWX")},mounted:function(){t.log(this.api2,"全局数据")},methods:{sendMessage:function(){var t=this.phoneLand.phone;return""===t?(uni.showToast({title:"手机号为不能为空",icon:"none",duration:1e3}),!1):/^1[345789]\d{9}$/.test(t)?!this.isOvertime&&void this.getCode():(uni.showToast({title:"手机号码有误,请重填",icon:"none",duration:1e3}),!1)},sendState:function(){var t=this,n=60,i=setInterval(function(){t.isOvertime=!0,n--,t.word="重新获取("+n+"s)",n<0&&(t.isOvertime=!1,clearInterval(i),t.word="获取验证码")},1e3)},getCode:function(){var n=this;uni.showLoading({title:"加载中"});var i={phone:this.phoneLand.phone,businessName:"1",portal:"ruhexiu"};uni.request({url:this.api1+"/rest-sso/phoneSms",data:i,method:"POST",header:{"custom-header":"hello"},success:function(i){t.log(i.data),"200"===i.data.ret?(uni.hideLoading(),uni.showToast({title:"短信发送成功",icon:"none",duration:1e3}),n.sendState()):(uni.hideLoading(),uni.showToast({title:i.data.msg,icon:"none",duration:1e3}))},fail:function(n){uni.hideLoading(),uni.showToast({title:"网络繁忙，请稍后",icon:"none",duration:1e3}),t.log(n,"网络繁忙，请稍后")}})},clickPassWordLand:function(){t.log("触发账号密码登录按钮"),this.landType=2,""!==this.phoneLand.phone&&(this.passWordLand.phone=this.phoneLand.phone),uni.setStorageSync("landType",this.landType)},clickPhoneLand:function(){t.log("触发手机号登录按钮"),this.landType=1,""!==this.passWordLand.phone&&(this.phoneLand.phone=this.passWordLand.phone),uni.setStorageSync("landType",this.landType)},clickForgetPassWord:function(){t.log("触发忘记密码按钮"),uni.navigateTo({url:"/pages/landRegistration/h5/forgetPassWord"})},clickLand:function(){t.log("触发登录按钮"),1===this.landType?(t.log("手机号登录"),this.phoneLandFn()):2===this.landType&&(t.log("密码登录"),this.passWordLandFn())},phoneLandFn:function(){var n=this,i=this.phoneLand.code,a=this.phoneLand.phone;if(""===a)return uni.showToast({title:"手机号为不能为空",icon:"none",duration:1e3}),!1;if(!/^1[345789]\d{9}$/.test(a))return uni.showToast({title:"手机号码有误,请重填",icon:"none",duration:1e3}),!1;if(""===i)return uni.showToast({title:"短信验证码不能为空",icon:"none",duration:1e3}),!1;if(!/^\d{4}$/.test(i))return uni.showToast({title:"验证码格式有误,请重填",icon:"none",duration:1e3}),!1;uni.showLoading({title:"加载中"});var o={phone:this.phoneLand.phone,loginType:"0",phoneCode:this.phoneLand.code};uni.request({url:this.api2+"/rest-rp/mbUser/login",data:o,method:"POST",header:{},success:function(i){if(t.log(i.data),"200"===String(i.data.ret)){uni.hideLoading();var a={randomKey:"",token:i.data.content.sign,user:{id:i.data.content.user.id}};uni.setStorageSync("landRegist",(0,e.default)(a)),t.log("登陆成功！"),n.password=i.data.content.user.password,n.getUserData()}else uni.hideLoading(),uni.showToast({title:i.data.msg,icon:"none",duration:1e3})},fail:function(n){uni.hideLoading(),uni.showToast({title:"网络繁忙，请稍后",icon:"none",duration:1e3}),t.log(n,"网络繁忙，请稍后")}})},passWordLandFn:function(){var n=this,i=this.passWordLand.phone,a=this.passWordLand.passWord;if(t.log(this.passWordLand),""===i)return uni.showToast({title:"手机号为不能为空",icon:"none",duration:1e3}),!1;if(!/^1[345789]\d{9}$/.test(i))return uni.showToast({title:"手机号码有误,请重填",icon:"none",duration:1e3}),!1;if(""===a)return uni.showToast({title:"密码为不能为空",icon:"none",duration:1e3}),!1;if(a.length<6)return uni.showToast({title:"密码不能少于6个字符",icon:"none",duration:1e3}),!1;uni.showLoading({title:"加载中"});var o={phone:this.passWordLand.phone,loginType:"1",passWord:this.passWordLand.passWord};uni.request({url:this.api2+"/rest-rp/mbUser/login",data:o,method:"POST",header:{"custom-header":"hello"},success:function(i){if(t.log(i.data),"200"===String(i.data.ret)){uni.hideLoading();var a={randomKey:"",token:i.data.content.sign,user:{id:i.data.content.user.id}};uni.setStorageSync("landRegist",(0,e.default)(a)),n.password=i.data.content.user.password,n.getUserData()}else uni.hideLoading(),uni.showToast({title:i.data.msg,icon:"none",duration:1e3})},fail:function(n){uni.hideLoading(),uni.showToast({title:"网络繁忙，请稍后",icon:"none",duration:1e3}),t.log(n,"网络繁忙，请稍后")}})},mergeUserData:function(){t.log("合并用户信息");var n=JSON.parse(uni.getStorageSync("landRegist"));t.log(uni.getStorageSync("UUID"),"uuid");var i=uni.getStorageSync("UUID");t.log(i,"存在的游客id"),t.log(n.user.id),uni.request({url:this.api2+"/rest-rp/follow/merg?uuid="+i+"&userId="+n.user.id,data:{},header:{Authorization:"Bearer "+n.token},success:function(n){t.log(n.data),"200"===String(n.data.ret)?t.log("游客模式和登录模式合并成功！"):(uni.hideLoading(),uni.showToast({title:n.data.msg,icon:"none",duration:500}))},fail:function(n){uni.hideLoading(),uni.showToast({title:"网络繁忙，请稍后",icon:"none",duration:1e3}),t.log(n,"网络繁忙，请稍后")}})},getUserData:function(){var n=this;t.log("获取用户信息，全部");var i=JSON.parse(uni.getStorageSync("landRegist"));t.log(i.user.id),uni.request({url:this.api2+"/rest-rp/user/"+i.user.id,data:{},header:{Authorization:"Bearer "+i.token},success:function(i){if(t.log(i.data),n.mergeUserData(),"200"===String(i.data.ret)){var a=i.data.content;uni.setStorageSync("UserData",(0,e.default)(a)),""===n.password||null===n.password||void 0===n.password?n.setPassWorld=!0:(uni.showToast({title:"登陆成功",icon:"none",duration:500}),uni.navigateBack({delta:1}),setTimeout(function(){var t="/pages/project/MBBO/home";if(uni.getStorageSync("localUrl")){var n=uni.getStorageSync("localUrl").split("#")[1];t=n}uni.navigateTo({url:t})},500))}else uni.hideLoading(),uni.showToast({title:i.data.msg,icon:"none",duration:500})},fail:function(n){uni.hideLoading(),uni.showToast({title:"网络繁忙，请稍后",icon:"none",duration:1e3}),t.log(n,"网络繁忙，请稍后")}})},clickSetPassWorld:function(){var n=this;t.log("触发保存密码按钮");var i=this.phoneLand.passWord;if(""===i)return uni.showToast({title:"密码不能为空",icon:"none",duration:500}),!1;if(i.length<6)return uni.showToast({title:"密码不能少于6个字符",icon:"none",duration:500}),!1;var a={passWord:this.phoneLand.passWord};if(uni.getStorageSync("landRegist")){var o=JSON.parse(uni.getStorageSync("landRegist"));t.log(o.user.id),uni.showLoading({title:"加载中"}),uni.request({url:this.api2+"/rest-rp/user/"+o.user.id,data:a,method:"POST",header:{Authorization:"Bearer "+o.token},success:function(i){if(t.log(i.data),"200"===String(i.data.ret)){if(uni.hideLoading(),uni.showToast({title:"登陆成功！",icon:"none",duration:500}),uni.getStorageSync("landRegist")){var a=JSON.parse(uni.getStorageSync("landRegist"));a.user.password=n.phoneLand.passWord,uni.setStorageSync("landRegist",(0,e.default)(a))}setTimeout(function(){uni.navigateTo({url:"/pages/project/MBBO/home"})},500)}else uni.hideLoading(),uni.showToast({title:i.data.msg,icon:"none",duration:500})},fail:function(n){uni.hideLoading(),uni.showToast({title:"网络繁忙，请稍后",icon:"none",duration:1e3}),t.log(n,"网络繁忙，请稍后")}})}},clickSkipLand:function(){t.log("触发暂不设置"),uni.navigateTo({url:"/pages/project/MBBO/home"})},clickWxLand:function(){t.log("触发微信登录");var n=uni.getStorageSync("UUID");window.location.href=this.api2+"/rest-rp/mbUser/goWxLogin?uuid="+n}}};n.default=s}).call(this,i("5a52")["default"])},eb5c:function(t,n,i){n=t.exports=i("2350")(!1),n.push([t.i,".landRegistration-content[data-v-a5e30066]{position:relative;width:100vw;height:100vh;background:#fff}.landRegistration[data-v-a5e30066]{position:relative;padding:%?18?% %?40?%;background:#fff}.phone-passWord-LR[data-v-a5e30066]{position:relative;width:100%;margin-top:12vw}.phonw-LR[data-v-a5e30066]{position:relative;width:100%;margin-top:6vw}.top-PLR[data-v-a5e30066]{position:relative;width:100%}.top-PLR>p[data-v-a5e30066]{font-family:PingFangSC-Semibold;font-size:6.4vw;color:#2e2e30;line-height:10vw}.LR-cont[data-v-a5e30066]{position:relative;width:100%;margin-top:8vw}.inputPhone-PLR[data-v-a5e30066]{position:relative;width:100%}.inputYan-PLR[data-v-a5e30066]{position:relative;width:100%}.yan-left-PLR[data-v-a5e30066]{position:relative;width:60%}.ma-right-PLR[data-v-a5e30066]{position:relative;width:40%}.yazm[data-v-a5e30066]{font-family:PingFangSC-Light;font-size:4vw;color:#ccc;line-height:12vw;text-align:right}.re-yazm[data-v-a5e30066]{font-family:PingFangSC-Light;font-size:4vw;color:#02c2a2;padding-top:2vw;text-align:right}.switchPassWorld[data-v-a5e30066]{position:relative;width:100%}.switchPassWorld>p[data-v-a5e30066]{font-family:PingFangSC-Light;font-size:3.5vw;color:#02c2a2;line-height:12vw;width:50%}.passWord-LR[data-v-a5e30066]{position:relative;width:100%}.top-PWLR[data-v-a5e30066]{position:relative;width:33.6vw;margin-top:6vw;margin:auto}.top-PWLR>img[data-v-a5e30066]{position:relative;width:100%}.landBtn[data-v-a5e30066]{position:relative;width:100%;margin-top:8vw}.land-btn-box[data-v-a5e30066]{position:relative;width:100%;height:12vw;margin-bottom:6vw}.land-btn-box>p[data-v-a5e30066]{font-family:PingFangSC-Regular;font-size:4.266vw;color:#fff;letter-spacing:0;text-align:center;line-height:12vw;background:#02c2a2}.wx-land[data-v-a5e30066]{font-family:PingFangSC-Regular;font-size:4.266vw;color:#02c2a2!important;letter-spacing:0;text-align:center;line-height:12vw;border:1px solid #e2e2e2;background:#fff!important}.text-Right[data-v-a5e30066]{text-align:right}.skipLand[data-v-a5e30066]{position:relative;width:100%;margin-top:4vw}.skipLand>p[data-v-a5e30066]{position:relative;width:100%;text-align:center;font-size:4vw;line-height:12vw;color:#15d49f}",""])}}]);